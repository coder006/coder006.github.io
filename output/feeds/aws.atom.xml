<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>All Things Connected - AWS</title><link href="https://ambar.dev/" rel="alternate"></link><link href="https://ambar.dev/feeds/aws.atom.xml" rel="self"></link><id>https://ambar.dev/</id><updated>2020-03-19T20:30:00+05:30</updated><entry><title>Setting up a VPN connection between AWS and Alicloud using Terraform</title><link href="https://ambar.dev/aws-alicloud-vpn-setup-terraform.html" rel="alternate"></link><published>2020-03-19T20:30:00+05:30</published><updated>2020-03-19T20:30:00+05:30</updated><author><name>Ambar Mehrotra</name></author><id>tag:ambar.dev,2020-03-19:/aws-alicloud-vpn-setup-terraform.html</id><summary type="html">&lt;p&gt;Setting up a VPN connection between AWS and Alicloud using Terraform&lt;/p&gt;</summary><content type="html">&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;Note&lt;/em&gt;&lt;/strong&gt;:
This is not a guide on the internals of a Virtual Private Network. Rather, this post outlines how to setup a VPN connection between AWS and Alicloud. This guide uses Terraform for making API calls and state management. You can chose to use any HTTP client or aws and alicloud CLIs as well for making the same API calls and end up with a working VPN connection.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;Problem Statement&lt;/h2&gt;
&lt;p&gt;When you are working in a multicloud environment, many scenarios involve establishing a communication channel between services and resources that lie across cloud providers. For example, you might have a common &lt;strong&gt;Rundeck&lt;/strong&gt; machine that deployes the build binaries onto virtual machines residing in AWS as well as Azure. Another example might be a script in your CI/CD platform that interacts periodically with resources across cloud providers like &lt;strong&gt;RDS&lt;/strong&gt;, &lt;strong&gt;Mongo&lt;/strong&gt;, &lt;strong&gt;RabbitMQ&lt;/strong&gt;, etc., for regularly monitoring or updating different ACL Policies.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Multi Cloud Architecture" src="https://www.simform.com/wp-content/uploads/2017/11/Blog-Diagram1.png" title="Multi Cloud Architecture"&gt;&lt;/p&gt;
&lt;p&gt;Creating a VPN connection helps you securely access resources on one cloud provider from another over an encrypted connection. A VPN connection helps you avoid the hassle of exposing public endpoints for each resource and then securing it. You can simply go ahead and whietelist a CIDR block across the VPCs and all your traffic in the given CIDR range will then be routed over this secure, encrypted connection.&lt;/p&gt;
&lt;h2&gt;VPN Setup&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;data&lt;/span&gt; &lt;span class="ss"&gt;&amp;quot;aws_route_table&amp;quot;&lt;/span&gt; &lt;span class="ss"&gt;&amp;quot;aws_private_subnet_rt&amp;quot;&lt;/span&gt; &lt;span class="err"&gt;{&lt;/span&gt;
  &lt;span class="n"&gt;subnet_id&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;var&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tooling&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;vpc&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;private_subnet_id&lt;/span&gt;
&lt;span class="err"&gt;}&lt;/span&gt;

&lt;span class="n"&gt;resource&lt;/span&gt; &lt;span class="ss"&gt;&amp;quot;alicloud_vpn_gateway&amp;quot;&lt;/span&gt; &lt;span class="ss"&gt;&amp;quot;aws_vpn_gateway&amp;quot;&lt;/span&gt; &lt;span class="err"&gt;{&lt;/span&gt;
  &lt;span class="n"&gt;name&lt;/span&gt;                 &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="ss"&gt;&amp;quot;AWS-VPN-Gateway&amp;quot;&lt;/span&gt;
  &lt;span class="n"&gt;vpc_id&lt;/span&gt;               &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;var&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vpc_details&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vpc_id&lt;/span&gt;
  &lt;span class="n"&gt;bandwidth&lt;/span&gt;            &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="ss"&gt;&amp;quot;10&amp;quot;&lt;/span&gt;
  &lt;span class="n"&gt;enable_ssl&lt;/span&gt;           &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;false&lt;/span&gt;
  &lt;span class="n"&gt;instance_charge_type&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="ss"&gt;&amp;quot;PostPaid&amp;quot;&lt;/span&gt;
  &lt;span class="n"&gt;description&lt;/span&gt;          &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="ss"&gt;&amp;quot;AWS-VPN-Gateway&amp;quot;&lt;/span&gt;
  &lt;span class="n"&gt;vswitch_id&lt;/span&gt;           &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;var&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vpc_details&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vswitch_ids&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="err"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</content><category term="AWS"></category><category term="aws"></category><category term="alicloud"></category><category term="terraform"></category><category term="vpn"></category></entry></feed>